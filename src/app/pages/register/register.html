<main class="page">
  <header class="page__heading">
    <h1 class="page__title">Crea tu cuenta</h1>
    <p class="page__subtitle">Únete a nuestra comunidad como usuario o anfitrión. Los anfitriones pueden publicar y gestionar alojamientos.</p>
  </header>

  <form class="form-card" [formGroup]="registerForm" (ngSubmit)="createUser()" novalidate style="max-width: 900px; width: 100%;">
    <div class="form-card__grid">
      <div class="form-group">
        <label for="register-name">Nombre</label>
        <input id="register-name" type="text" formControlName="name" placeholder="Tu nombre" />
        @if (registerForm.get('name')?.invalid && registerForm.get('name')?.touched) {
          <small class="error-message">El nombre es obligatorio.</small>
        }
      </div>

      <div class="form-group">
        <label for="register-surname">Apellido</label>
        <input id="register-surname" type="text" formControlName="surname" placeholder="Tu apellido" />
        @if (registerForm.get('surname')?.invalid && registerForm.get('surname')?.touched) {
          <small class="error-message">El apellido es obligatorio.</small>
        }
      </div>

      <div class="form-group">
        <label for="register-email">Email</label>
        <input id="register-email" type="email" formControlName="email" placeholder="correo@ejemplo.com" />
      </div>

      <div class="form-group">
        <label for="register-phone">Teléfono</label>
        <input id="register-phone" type="text" formControlName="phone" placeholder="300 000 0000" />
        @if (registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched) {
          @if (registerForm.get('phone')?.hasError('required')) {
            <small class="error-message">El teléfono es obligatorio.</small>
          }
          @else if (registerForm.get('phone')?.hasError('maxlength')) {
            <small class="error-message">El teléfono debe tener máximo 10 caracteres.</small>
          }
        }
      </div>

      <div class="form-group">
        <label for="register-birth">Fecha de nacimiento</label>
        <input id="register-birth" type="date" formControlName="birthDate" />
        @if (registerForm.get('birthDate')?.invalid && registerForm.get('birthDate')?.touched) {
          <small class="error-message">La fecha de nacimiento es obligatoria.</small>
        }
      </div>

      <div class="form-group">
        <label for="register-country">País</label>
        <input id="register-country" type="text" formControlName="country" placeholder="Colombia" readonly />
        <small class="form-helper">Por ahora solo disponible en Colombia</small>
      </div>

      <div class="form-group">
        <label for="register-password">Contraseña</label>
        <input id="register-password" type="password" formControlName="password" placeholder="••••••" />
        <small class="form-helper">Mínimo 6 caracteres</small>
        @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
          @if (registerForm.get('password')?.hasError('required')) {
            <small class="error-message">La contraseña es obligatoria.</small>
          }
          @else if (registerForm.get('password')?.hasError('minlength')) {
            <small class="error-message">La contraseña debe tener al menos 6 caracteres.</small>
          }
        }
      </div>

      <div class="form-group">
        <label for="register-repeat-password">Repetir contraseña</label>
        <input id="register-repeat-password" type="password" formControlName="repeatPassword" placeholder="••••••" />
        @if (registerForm.get('repeatPassword')?.invalid && registerForm.get('repeatPassword')?.touched) {
          <small class="error-message">Repetir la contraseña es obligatorio.</small>
        }
      </div>

      <div class="form-group">
        <label for="register-photo">Foto de perfil (opcional)</label>
        <input id="register-photo" type="file" (change)="onFileChange($event)" />
        <small class="form-helper">Formatos permitidos: JPG o PNG (máx. 5MB)</small>
      </div>

      <div class="form-group">
        <label for="register-role">Tipo de cuenta</label>
        <select id="register-role" formControlName="role">
          <option value="">Selecciona el tipo de cuenta</option>
          @for (roleOption of userRoles; track roleOption.value) {
            <option [value]="roleOption.value">{{ roleOption.label }}</option>
          }
        </select>
        @if (registerForm.get('role')?.invalid && registerForm.get('role')?.touched) {
          <small class="error-message">Debes seleccionar un tipo de cuenta.</small>
        }
      </div>

      @if (registerForm.hasError('passwordsMismatch')) {
        <div class="alert alert-danger" role="alert">Las contraseñas no coinciden</div>
        }
    </div>

    <div class="d-flex justify-content-center">
        <button class="btn btn-primary d-flex align-items-center justify-content-center gap-1" type="submit">
            <span class="material-symbols-rounded">person_add</span>
            Registrarse
        </button>
    </div>
  </form>
</main>
